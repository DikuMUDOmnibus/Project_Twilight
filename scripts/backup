#!/bin/csh

cd ~/ptmud/src
make wipe
cd ~/ptmud/area
rm core
cd ~

    set index = 1000
    while ( 1 )
	set logfile = $index
	if ( ! -e $logfile.tgz ) break
	@ index++
    end

tar -cvf player-`date "+%d_%b_%Y_%H_%M"`.tar ptmud/player/
gzip player-`date "+%d_%b_%Y_%H_%M"`.tar
mv player-`date "+%d_%b_%Y_%H_%M"`.tar.gz player-`date "+%d_%b_%Y_%H_%M"`.tgz
chmod og-rwx player-`date "+%d_%b_%Y_%H_%M"`.tgz

tar -cvf area-`date "+%d_%b_%Y_%H_%M"`.tar ptmud/area/
gzip area-`date "+%d_%b_%Y_%H_%M"`.tar
mv area-`date "+%d_%b_%Y_%H_%M"`.tar.gz area-`date "+%d_%b_%Y_%H_%M"`.tgz
chmod og-rwx area-`date "+%d_%b_%Y_%H_%M"`.tgz

tar -cvf src-`date "+%d_%b_%Y_%H_%M"`.tar ptmud/src/
gzip src-`date "+%d_%b_%Y_%H_%M"`.tar
mv src-`date "+%d_%b_%Y_%H_%M"`.tar.gz SRC-`date "+%d_%b_%Y_%H_%M"`.tgz
chmod og-rwx SRC-`date "+%d_%b_%Y_%H_%M"`.tgz

ls mud/log/ >> log

tar -cvf mud-`date "+%d_%b_%Y_%H_%M"`.tar ptmud/ --exclude-from ~/log
gzip mud-`date "+%d_%b_%Y_%H_%M"`.tar
mv mud-`date "+%d_%b_%Y_%H_%M"`.tar.gz MUD-`date "+%d_%b_%Y_%H_%M"`.tgz
chmod og-rwx MUD-`date "+%d_%b_%Y_%H_%M"`.tgz

rm log

#tar -cvf web.tar public_html/projecttwilight/
#gzip web.tar
#mv web.tar.gz WEB.tgz
#chmod og-rwx WEB.tgz

cd ~/ptmud/src/
make

cd ~
mv *.tgz ./backup

rm ~/ptmud/src/completedbackup
